options {
        directory           	"/etc/named/";
        # Close recursion
        recursion               no;
        # Close fetch-glue
        fetch-glue              no;
        # Hide version
        version                 "Unknown";
        listen-on port 53   	{ any; };
        max-recursion-queries 	200;
        dump-file       	"/etc/named/data/cache_dump.db";
        statistics-file 	"/etc/named/data/named_stats.txt";
        allow-query     	{ any; };
        blackhole       	{ none; };
};

#rndc

#statistics

view "ours_domain" {
        match-clients           { any; };
        allow-query-cache       { any; };
        allow-recursion         { any; };
        allow-transfer          { none; };

        dlz "Mysql Zone" {
   		database "mysql
                {${MYSQL_DATA_SOURCE}}
   		{select zone from dns_records where zone = '$zone$'}
   		{select ttl, type, mx_priority, case when lower(type)='txt' then concat('\"', data, '\"')
        		when lower(type) = 'soa' then concat_ws(' ', data, resp_person, serial, refresh, retry, expire, minimum)
        		else data end from dns_records where zone = '$zone$' and host = '$record$'}";
	};


        zone "."  IN {
            type hint;
            file "named.ca";
        };
};
